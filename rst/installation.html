

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Build instructions &mdash; balder  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/collapsible-lists/css/tree_view.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/icon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
        <script src="../_static/mathwork.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Private API" href="../api/library-api.html" />
    <link rel="prev" title="Data sharing" href="signals.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #00457c" >
          

          
            <a href="../index.html" class="icon icon-home"> balder
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#component-overview">Component overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#screendumps-of-application">Screendumps of application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#usage">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#running-the-application">Running the application</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#typical-usage-session">Typical usage session</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="signals.html">Data sharing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="signals.html#signal-overview">Signal overview</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer zone</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Build instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-options-and-targets">Configuration options and targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linux">Linux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites-debian-based">Prerequisites (debian-based)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation-prerequisites-optional">Documentation prerequisites <em>(optional)</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running-debian-based">Building and running (debian-based)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#packaging-into-artifacts">Packaging into artifacts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#windows">Windows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation-prerequisites-on-windows-optional">Documentation prerequisites on Windows <em>(optional)</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running">Building and running</a></li>
<li class="toctree-l3"><a class="reference internal" href="#packaging-into-installer-and-archive">Packaging into installer and archive</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#android">Android</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/library-api.html">Private API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/library-api.html#class-hierarchy">Class Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/library-api.html#file-hierarchy">File Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/library-api.html#items-listing">Items listing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/library-api.html#namespaces">Namespaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/namespace_fkin__Dds.html">Namespace fkin::Dds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/namespace_ratatosk.html">Namespace ratatosk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/library-api.html#classes-and-structs">Classes and Structs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/classbalder.html">Class balder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinControls.html">Class FkinControls</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinDdsTopics.html">Class FkinDdsTopics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinDecisionIndicator.html">Class FkinDecisionIndicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinFooter.html">Class FkinFooter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinInfoDash.html">Class FkinInfoDash</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinPurseDashboard.html">Class FkinPurseDashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinSettings.html">Class FkinSettings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinStyle.html">Class FkinStyle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classFkinTimeSeries.html">Class FkinTimeSeries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classInfoDirectionMagnitude.html">Class InfoDirectionMagnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classInfoPlanning.html">Class InfoPlanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classNlpInfo.html">Class NlpInfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classNorthEast.html">Class NorthEast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classRemoteProgramCommands.html">Class RemoteProgramCommands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classRemoteProgramGroup.html">Class RemoteProgramGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classSplash.html">Class Splash</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classTabIconButton.html">Class TabIconButton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classTimeChart.html">Class TimeChart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/classTransformToNED.html">Class TransformToNED</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">balder</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Build instructions</li>
    
    

<li class="wy-breadcrumbs-aside">
  <a href="https://github.com/sintef-ocean/balder" class="fa fa-github"> Source on GitHub</a>
  <a href="https://docs.sintef.io" class="icon icon-home"> docs.sintef.io</a>
</li>


  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="../api/library-api.html" class="btn btn-neutral float-right" title="Private API" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="signals.html" class="btn btn-neutral float-left" title="Data sharing" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="build-instructions">
<h1>Build instructions<a class="headerlink" href="#build-instructions" title="Permalink to this headline">¶</a></h1>
<p>You need a compiler that supports <em>c++17</em> to build <code class="docutils literal notranslate"><span class="pre">balder</span></code>. It is known to compile
with <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">8</span></code>, <code class="docutils literal notranslate"><span class="pre">clang</span> <span class="pre">9</span></code>, and <code class="docutils literal notranslate"><span class="pre">msvc++</span> <span class="pre">14.2</span></code>. You need the <a class="reference external" href="https://cmake.org/">CMake</a> build system
generator. The application requires <a class="reference external" href="https://sintef-ocean.github.io/sinspekto">sinspekto</a> and <a class="reference external" href="https://www.qt.io/">Qt</a>.</p>
<p>The <strong>recommended</strong> approach to build the application is with the help of <a class="reference external" href="https://conan.io/">conan</a>. <code class="docutils literal notranslate"><span class="pre">conan</span></code> is
a python tool, and once installed, you need to set the following conan remotes.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m pip install conan

conan remote add sintef https://artifactory.smd.sintef.no/api/conan/conan-local
conan remote add bincrafters https://api.bintray.com/conan/bincrafters/public-conan
conan config <span class="nb">set</span> general.revisions_enabled<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>Building the documentation is <em>optional</em>. It is generated using <code class="docutils literal notranslate"><span class="pre">doxygen</span></code>, <code class="docutils literal notranslate"><span class="pre">sphinx</span></code>,
<code class="docutils literal notranslate"><span class="pre">emacs</span></code>, and <code class="docutils literal notranslate"><span class="pre">plantuml</span></code>. You also need the following python modules
(<code class="docutils literal notranslate"><span class="pre">docs/requirements.txt</span></code>):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">breathe</span>
<span class="na">Sphinx &gt;</span><span class="o">=</span> <span class="s">4.0.0</span>
<span class="na">doxyqml</span>
<span class="na">exhale</span>
<span class="na">sphinx-rtd-theme</span>
<span class="na">sphinxcontrib-plantuml</span>
<span class="na">sphinxcontrib-svg2pdfconverter</span>
<span class="na">doc2dash</span>
</pre></div>
</div>
<p>Instructions for each platform is found below.</p>
<div class="section" id="configuration-options-and-targets">
<h2>Configuration options and targets<a class="headerlink" href="#configuration-options-and-targets" title="Permalink to this headline">¶</a></h2>
<p>The table below specifies available options when building the application.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 10%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>CMake Option</p></th>
<th class="head"><p>conan option</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>See comment</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">with_fPIC</span></code></p></td>
<td><p>True</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CMAKE_POSITION_INDEPENDENT_CODE=ON</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">WITH_DOC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">with_doc</span></code></p></td>
<td><p>False</p></td>
<td><p>Use <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">--build</span> <span class="pre">.</span> <span class="pre">--target</span> <span class="pre">doc</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">WITH_INSTALL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">with_install</span></code></p></td>
<td><p>False</p></td>
<td><p>Deploy APK to connected device (android)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">WITH_CONSOLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">with_console</span></code></p></td>
<td><p>False</p></td>
<td><p>Terminal window side-by-side GUI (windows)</p></td>
</tr>
</tbody>
</table>
<p>The following build targets are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">doc</span></code> will build documentation html.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">package_it</span></code> will create <em>.deb</em> (linux), <em>.exe</em> (windows), and <em>.tar.gz</em> (not android)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">appimage</span></code> (linux) will create an <em>.AppImage</em> executable.</p></li>
</ul>
<p>If the executable is built without <code class="docutils literal notranslate"><span class="pre">conan</span></code>, the Debian packages will contain
dependencies to system packages (and <code class="docutils literal notranslate"><span class="pre">sinspekto-runtime</span></code>, which is non-standard).</p>
<ul class="simple">
<li><p>An additional option <code class="docutils literal notranslate"><span class="pre">WITH_API_DOC=OFF</span></code> disables API documentation, and enables LaTeX
and PDF output of the user documentation. This currently requires linux OS,
<code class="docutils literal notranslate"><span class="pre">inkscape</span></code>, <code class="docutils literal notranslate"><span class="pre">latexmk</span></code>, and a LaTeX distribution to be installed. The output will be
available in <code class="docutils literal notranslate"><span class="pre">&lt;build_folder&gt;/docs/sphinx/latex/</span></code>.</p></li>
</ul>
</div>
<div class="section" id="linux">
<h2>Linux<a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites-debian-based">
<h3>Prerequisites (debian-based)<a class="headerlink" href="#prerequisites-debian-based" title="Permalink to this headline">¶</a></h3>
<p>These instructions assume a <code class="docutils literal notranslate"><span class="pre">gcc</span></code> compiler and using <code class="docutils literal notranslate"><span class="pre">conan</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install -y build-essential cmake pkg-config python3-pip
python -m pip install setuptools wheel conan
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There may be other (unknown) packages needed by transitive dependencies, which are
not installed by conan. You may either install them manually when build errors occur,
or you can set environment variable <a class="reference external" href="https://docs.conan.io/en/latest/reference/env_vars.html#conan-sysrequires-mode">CONAN SYSREQUIRES MODE=enabled</a>, which lets conan
automatically install them for you.</p>
</div>
</div>
<div class="section" id="documentation-prerequisites-optional">
<h3>Documentation prerequisites <em>(optional)</em><a class="headerlink" href="#documentation-prerequisites-optional" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install -y doxygen emacs-nox graphviz plantuml wget
python -m pip install -r docs/requirements.txt --upgrade
emacs -Q --batch -l docs/emacs-install-pkgs.el
</pre></div>
</div>
<p>If your distribution is a bit old, you may have to update <code class="docutils literal notranslate"><span class="pre">plantuml</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://sourceforge.net/projects/plantuml/files/plantuml.jar
mv plantuml.jar /usr/share/plantuml/
</pre></div>
</div>
</div>
<div class="section" id="building-and-running-debian-based">
<h3>Building and running (debian-based)<a class="headerlink" href="#building-and-running-debian-based" title="Permalink to this headline">¶</a></h3>
<p>To install dependencies and build the application you can run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
conan install .. <span class="se">\</span>
  --options balder:with_doc<span class="o">=</span>True <span class="se">\</span>
  --build missing <span class="se">\</span>
  --settings compiler.libcxx<span class="o">=</span>libstdc++11
conan build ..
</pre></div>
</div>
<p>You need to activate virtual environments to run the built application.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. activate.sh     <span class="c1"># Opensplice environment variables</span>
. activate_run.sh <span class="c1"># Dynamic libraries added to LD_LIBRARY_PATH</span>
bin/balder
</pre></div>
</div>
</div>
<div class="section" id="packaging-into-artifacts">
<h3>Packaging into artifacts<a class="headerlink" href="#packaging-into-artifacts" title="Permalink to this headline">¶</a></h3>
<p>The project builds into various artifacts on Linux.</p>
<ul class="simple">
<li><p><em>.AppImage</em> executable, build target <code class="docutils literal notranslate"><span class="pre">appimage</span></code>, only for <code class="docutils literal notranslate"><span class="pre">x86_64/amd64</span></code>
architecture.</p></li>
<li><p><em>.deb</em> package, build target <code class="docutils literal notranslate"><span class="pre">package_it</span></code>.</p></li>
<li><p><em>.tar.gz</em> archive, build target <code class="docutils literal notranslate"><span class="pre">package_it</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">package</span> <span class="pre">..</span></code> will build all supported targets.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When building with conan, the <em>.deb</em> package will not be built with system package
dependencies. This is because the system packages likely are not the versions as the
built executable expects. Also, the package is not bundled with the necessary
libraries and resources in order to run.</p>
</div>
<p>The AppImage packaging uses <a class="reference external" href="https://github.com/linuxdeploy/linuxdeploy">linuxdeploy</a> with <a class="reference external" href="https://github.com/linuxdeploy/linuxdeploy-plugin-qt">linuxdeploy-plugin-qt</a> to create an
executable <a class="reference external" href="https://docs.appimage.org/index.html">AppImage</a>. The deployment tools are downloaded by CMake automatically. The
packaging creates an <em>balder-&lt;version&gt;-&lt;arch&gt;.AppImage</em>. ImageMagick is needed and the
virtual run environment must be active, since the dynamic libraries must be available
on <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code>, and also conan-installed binary <code class="docutils literal notranslate"><span class="pre">qmake</span></code> when running
linuxdeploy.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install -y imagemagick
<span class="nb">cd</span> build
. activate_run.sh
conan package ..
</pre></div>
</div>
<ul class="simple">
<li><p>Instead of <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">package</span> <span class="pre">..</span></code>, it is possible to build only a selected target with
<code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">activate.sh</span> <span class="pre">&amp;&amp;</span> <span class="pre">cmake</span> <span class="pre">--build</span> <span class="pre">.</span> <span class="pre">--target</span> <span class="pre">appimage</span></code>, or <code class="docutils literal notranslate"><span class="pre">package_it</span></code>.</p></li>
<li><p>By default, the application loads a bundled config file. It can be overridden by
setting the environment variable: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OSPL_URI=file:///path/to/ospl.xml</span></code>.</p></li>
<li><p>To run an AppImage, <code class="docutils literal notranslate"><span class="pre">fuse</span></code> may be required, alternatively, run the application with
the following flag: <code class="docutils literal notranslate"><span class="pre">./balder-1.0.0_x86_64.AppImage</span> <span class="pre">--appimage-extract-and-run</span></code>.</p></li>
<li><p>Internally, <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">package</span></code> calls <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">--build</span> <span class="pre">.</span> <span class="pre">--target</span> <span class="pre">appimage</span></code> and will
create the <em>AppImage</em>, which should contain almost all dependencies for running the
application. The file can be run as a desktop application or from the command line.</p></li>
<li><p>The contents of <code class="docutils literal notranslate"><span class="pre">AppDir</span></code> in the build directory is packaged in the <em>AppImage</em> file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AppRun</span></code> is the entry script of the application.</p></li>
<li><p>To “Install” an AppImage, perhaps <a class="reference external" href="https://github.com/TheAssassin/AppImageLauncher">AppImageLauncher</a> is useful.</p></li>
<li><p>Need to build on “oldest” distro you want to support to ensure standard library
compliance.</p></li>
<li><p>The only supported architecture is <code class="docutils literal notranslate"><span class="pre">x86_64/amd64</span></code>, because the used linuxdeploy
appimages are not pre-built for arm-based CPUs.</p></li>
<li><p>When building in a container, set environment variable <code class="docutils literal notranslate"><span class="pre">APPIMAGE_EXTRACT_AND_RUN=1</span></code></p></li>
<li><p>It is possible to use <code class="docutils literal notranslate"><span class="pre">--appimage-extract</span></code> and then create a symlink on <code class="docutils literal notranslate"><span class="pre">PATH</span></code> to
the extracted <code class="docutils literal notranslate"><span class="pre">AppRun</span></code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="windows">
<h2>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>Prerequisites using <code class="docutils literal notranslate"><span class="pre">conan</span></code>. Most commands expect you to run with elevated privileges.
We make use of <a class="reference external" href="https://chocolatey.org/">chocolatey</a> package manager for windows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>powershell -Command Set-ExecutionPolicy Bypass -Scope Process -Force<span class="p">;</span> <span class="se">\</span>
  <span class="o">[</span>System.Net.ServicePointManager<span class="o">]</span>::SecurityProtocol <span class="o">=</span> <span class="se">\</span>
  <span class="o">[</span>System.Net.ServicePointManager<span class="o">]</span>::SecurityProtocol -bor <span class="m">3072</span><span class="p">;</span> <span class="se">\</span>
  iex <span class="o">((</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span> <span class="se">\</span>
  <span class="s1">&#39;https://chocolatey.org/install.ps1&#39;</span><span class="o">))</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>choco install -y python3 Wget
choco install -y cmake --installargs <span class="s1">&#39;&quot;ADD_CMAKE_TO_PATH=System&quot;&#39;</span>
choco install -y git.install --params <span class="s2">&quot;/GitAndUnixToolsOnPath&quot;</span>
python -m pip install setuptools wheel conan win-unicode-console
</pre></div>
</div>
<p>Microsoft Visual Studio build tools if they are not already installed.
These commands must to be run with <code class="docutils literal notranslate"><span class="pre">cmd.exe</span></code>.
<strong>Note</strong> that the <code class="docutils literal notranslate"><span class="pre">vs_buildtools.exe</span></code> will run in the background.
These steps are not necessary if you have Visual Studio with C++ compilers installed.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir C:<span class="se">\T</span>EMP <span class="o">&amp;&amp;</span> <span class="nb">cd</span> C:<span class="se">\T</span>EMP
wget https://aka.ms/vs/16/release/vs_buildtools.exe
vs_buildtools.exe --quiet --norestart --wait --nocache <span class="se">\</span>
  --installPath C:<span class="se">\B</span>uildTools <span class="se">\</span>
  --add Microsoft.VisualStudio.Workload.MSBuildTools <span class="se">\</span>
  --add Microsoft.VisualStudio.Workload.VCTools --includeRecommended
setx path <span class="s2">&quot;%path%;C:\BuildTools\Common7\Tools&quot;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may need to start new command window sessions between commands to load the new PATH variables.</p>
</div>
</div>
<div class="section" id="documentation-prerequisites-on-windows-optional">
<h3>Documentation prerequisites on Windows <em>(optional)</em><a class="headerlink" href="#documentation-prerequisites-on-windows-optional" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>choco install -y doxygen.install emacs plantuml
choco install -y graphviz.portable --force <span class="c1"># Maybe optional: 2.44 broken, downgrades to 2.38</span>
python -m pip install -r docs/requirements.txt --upgrade
emacs -Q --batch -l docs/emacs-install-pkgs.el
</pre></div>
</div>
</div>
<div class="section" id="building-and-running">
<h3>Building and running<a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h3>
<p>To install dependencies and build the application you can run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build
<span class="nb">cd</span> build
conan install .. <span class="se">\</span>
  --options balder:with_doc<span class="o">=</span>True <span class="se">\</span>
  --build missing
conan build ..
</pre></div>
</div>
<p>You need to use a virtual environment to run the application.
<code class="docutils literal notranslate"><span class="pre">activate.bat</span></code> sets <code class="docutils literal notranslate"><span class="pre">OSPL_URI</span></code> and <code class="docutils literal notranslate"><span class="pre">OSPL_HOME</span></code> environment variables.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>activate.bat
<span class="nb">cd</span> bin
balder.exe
</pre></div>
</div>
</div>
<div class="section" id="packaging-into-installer-and-archive">
<h3>Packaging into installer and archive<a class="headerlink" href="#packaging-into-installer-and-archive" title="Permalink to this headline">¶</a></h3>
<p>The project is set up with packaging into an executable installer (<em>.exe.</em>) and an
archive (<em>.tar.gz</em>) using the build target named <code class="docutils literal notranslate"><span class="pre">package_it</span></code>. The installer is made
with <a class="reference external" href="https://nsis.sourceforge.io/Main_Page">NSIS</a> through CPack. NSIS and can be installed with chocolatey:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>choco install -y nsis
</pre></div>
</div>
<p>The packager uses <code class="docutils literal notranslate"><span class="pre">windeployqt.exe</span></code>, which is bundled with Qt. Create the artifacts with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> build
conan package ..
<span class="c1"># or</span>
activate_run.bat
cmake --build . --config Release --target package_it
</pre></div>
</div>
<ul class="simple">
<li><p>By default, the application loads a bundled configuration file <code class="docutils literal notranslate"><span class="pre">ospl.xml</span></code>. It can be
overridden by setting the environment variable: <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">OSPL_URI=file://C:\\path\\to\\ospl.xml</span></code>.</p></li>
<li><p>There is also a batch script <code class="docutils literal notranslate"><span class="pre">ospl_env.bat</span></code>, which can be run before the application
in the same session on the command line. It sets <code class="docutils literal notranslate"><span class="pre">OSPL_URI</span></code> and <code class="docutils literal notranslate"><span class="pre">OSPL_HOME</span></code>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the package is installed with docs, <code class="docutils literal notranslate"><span class="pre">WIN</span> <span class="pre">+</span> <span class="pre">&quot;Balder</span> <span class="pre">Documentation'&quot;</span></code> should link to the bundled html documentation.</p>
</div>
</div>
</div>
<div class="section" id="android">
<h2>Android<a class="headerlink" href="#android" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We offer only highly experimental Android support.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The android compilation is only tested on a Linux platform.</p>
</div>
<p>You need to have Android SDK and NDK installed. The recipe itself uses it, but if some
dependencies need building, environment variables need to be on path. The
following command will help in that regard:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build_help <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build_help
conan install <span class="s2">&quot;android-cmdline-tools/[&gt;=6858069]@joakimono/testing&quot;</span> <span class="se">\</span>
  --generator virtualenv <span class="se">\</span>
  --profile<span class="o">=</span>../tools/profiles/android_amd64_api29 <span class="se">\</span>
  --build missing
. activate.sh
<span class="nb">cd</span> ..
</pre></div>
</div>
<p>The build process makes use of <a class="reference external" href="https://github.com/OlivierLDff/QtAndroidCMake">QtAndroidCMake</a> to create an APK bundle. During the build
process, the created <em>.apk</em> can be installed directly to a connected Android device with
the conan option <code class="docutils literal notranslate"><span class="pre">with_install=True</span></code>, (CMake: <code class="docutils literal notranslate"><span class="pre">WITH_INSTALL=ON</span></code>).</p>
<p>This project are bundled with some pre-made profiles in <code class="docutils literal notranslate"><span class="pre">tools/profiles</span></code> for common
architectures. Below we show how to compile for <code class="docutils literal notranslate"><span class="pre">x86_64</span></code> with API level 29 (Android 10):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
conan install .. <span class="se">\</span>
  --profile<span class="o">=</span>../tools/profiles/android_amd64_api29 <span class="se">\</span>
  --build missing
conan build ..
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The packaging uses a self-signed keystore <code class="docutils literal notranslate"><span class="pre">data/balder.keystore</span></code> for its call to
<code class="docutils literal notranslate"><span class="pre">add_qt_android_apk()</span></code> in <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>. This should be replaced with your own
signing keystore and information updated accordingly in <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.
<a class="reference external" href="https://ourcodeworld.com/articles/read/36/how-to-self-sign-and-verify-android-application-apk-in-windows-manually">See self signing</a> on how ot create a keystore.</p>
</div>
<p>Internally the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">build</span> <span class="pre">..</span></code> is almost equivalent to the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> activate.sh
cmake <span class="se">\</span>
  -DCMAKE_BUILD_TYPE<span class="o">=</span>Release <span class="se">\</span>
  -DCMAKE_TOOLCHAIN_FILE<span class="o">=</span><span class="nv">$CONAN_CMAKE_TOOLCHAIN_FILE</span> <span class="se">\</span>
  -DANDROID_PLATFORM<span class="o">=</span><span class="nv">$ANDROID_PLATFORM</span> <span class="se">\</span>
  -DANDROID_ABI<span class="o">=</span><span class="nv">$ANDROID_ABI</span> <span class="se">\</span>
  -DANDROID_STL<span class="o">=</span><span class="nv">$ANDROID_STL</span> <span class="se">\</span>
  -DCMAKE_FIND_ROOT_PATH_MODE_PACKAGE<span class="o">=</span>ON <span class="se">\</span>
  ..
cmake --build . --parallel <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>If the AppImage fails with <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">symbol</span> <span class="pre">lookup</span> <span class="pre">error</span> <span class="pre">...</span> <span class="pre">version</span> <span class="pre">Qt_5_PRIVATE_API</span></code>, you
forgot <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">activate_run.sh</span></code> before <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">package</span> <span class="pre">..</span></code>, delete the build folder and try
again.</p></li>
<li><p>If there is an issue compiling qt, similar to <a class="reference external" href="https://github.com/bincrafters/community/issues/1228">this</a>. Solution was to <code class="docutils literal notranslate"><span class="pre">unset</span> <span class="pre">CPATH</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">deactivate.sh</span></code> does not properly unset <code class="docutils literal notranslate"><span class="pre">OSPL_HOME</span></code>, which may cause issues, use
<code class="docutils literal notranslate"><span class="pre">unset</span> <span class="pre">OSPL_HOME</span></code></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../api/library-api.html" class="btn btn-neutral float-right" title="Private API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="signals.html" class="btn btn-neutral float-left" title="Data sharing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, SINTEF Ocean.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. <jinja2.runtime.BlockReference object at 0x7f64d8f51910>

<br /><br />
<table>
  <tr>
    <td width="120" style="vertical-align:middle;text-align:center">
      <img alt="FHF" style="border-width:0" width="100" src="../_static/FHF-black-txt.png" />
    </td>
    <td>
      This work was funded by <a href="https://www.fhf.no/fhf/about-fhf-english">FHF &ndash; Norwegian Seafood Research Fund</a> with <a href="https://www.fhf.no/prosjekter/prosjektbasen/901350/">Grant No. 901350</a>.<br /><br />
    </td>
  </tr>
  <tr>
    <td width="90" style="vertical-align:middle;text-align:center">
      <img alt="GNU General Public License, Version 3.0" style="border-width:0" width="90" src="https://upload.wikimedia.org/wikipedia/commons/9/93/GPLv3_Logo.svg" />
    </td>
    <td>
      This program is free software: you can redistribute it and/or modify
      it under the terms of the GNU General Public License as published by
      the Free Software Foundation, either version 3 of the License, or
      (at your option) any later version.<br /><br />

      This program is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU General Public License for more details.<br /><br />

      You should have received a copy of the GNU General Public License
      along with this program.  If not, see <a rel="license" href="https://www.gnu.org/licenses/">gnu.org/licenses</a>.
    </td>
  </tr>
</table>


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>